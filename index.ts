import { createPublicClient, http } from "viem";
import { optimismSepolia, sepolia } from "viem/chains";
import { buildProveWithdrawal, getL2Output } from "viem/op-stack";

async function main() {
  const l1 = createPublicClient({
    chain: sepolia,
    transport: http(sepolia.rpcUrls.default.http[0]),
  });

  const l2 = createPublicClient({
    chain: optimismSepolia,
    transport: http(optimismSepolia.rpcUrls.default.http[0]),
  });

  const output = await getL2Output(l1, {
    l2BlockNumber: BigInt(9248350),
    portalAddress: "0x16Fc5058F25648194471939df75CF27A2fdC48BC",
    l2OutputOracleAddress: "0x90E9c4f8a994a250F6aEfd61CAFb4F2e895D458F",
    disputeGameFactoryAddress: "0x05F9613aDB30026FFd634f38e5C4dFd30a197Fa1",
    chain: null,
  });
  console.log(output);

  const args = await buildProveWithdrawal(l1, {
    output,
    withdrawal: {
      nonce:
        1766847064778384329583297500742918515827483896875618958121606201292621636n,
      sender: "0x4200000000000000000000000000000000000007",
      target: "0x58Cc85b8D04EA49cC6DBd3CbFFd00B4B8D6cb3ef",
      value: 10000000000000n,
      gasLimit: 491310n,
      data: "0xd764ad0b00010000000000000000000000000000000000000000000000000000000007000000000000000000000000004200000000000000000000000000000000000010000000000000000000000000fbb0621e0b23b5478b630bd55a5f21f67730b0f1000000000000000000000000000000000000000000000000000009184e72a0000000000000000000000000000000000000000000000000000000000000030d4000000000000000000000000000000000000000000000000000000000000000c000000000000000000000000000000000000000000000000000000000000000c41635f5fd0000000000000000000000004444d38c385d0969c64c4c8f996d7536d16c28b90000000000000000000000004444d38c385d0969c64c4c8f996d7536d16c28b9000000000000000000000000000000000000000000000000000009184e72a0000000000000000000000000000000000000000000000000000000000000000080000000000000000000000000000000000000000000000000000000000000000b737570657262726964676500000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000",
      withdrawalHash:
        "0x8112d297788a17191e7239a03b6e93ae18c3d9f35f6f60cf52983434d54de9f2",
    },

    portalAddress: "0x16Fc5058F25648194471939df75CF27A2fdC48BC",
    disputeGameFactoryAddress: "0x05F9613aDB30026FFd634f38e5C4dFd30a197Fa1",
  });
  console.log(args);
}
main();
